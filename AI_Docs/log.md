# 作業ログ (log.md)

## Step 1: 開発環境構築とGitHub Pages設定 (2025-04-22)

### うまくいった手法（手順）

1. **段階的な環境構築アプローチ**

   - 基本環境（Vite+React+TypeScript）→UI（Tailwind+shadcn/ui）→機能（dnd-kit等）→品質管理（ESLint+Prettier+Playwright）の順で導入
   - 各ステップで動作確認を行い、問題があればすぐに対処

2. **複合ビルドプロセスの設定**

   - vite.config.tsでdocsディレクトリへのビルド出力設定
   - package.jsonでGitHub Pages用のURLパス設定
   - コードチェック（lint+format）をビルド前に自動実行する設定

3. **テスト駆動開発の導入**
   - 基本UIに対するPlaywrightテストの作成
   - 自動化テストによる品質保証の基盤確立

### 汎用的なナレッジ（タスク進め方や問題解決手法など）

1. **モジュール間の依存関係理解の重要性**

   - shadcn/uiはTailwind CSSに依存するため、導入順序は重要
   - tsconfig.jsonのパス設定はエイリアスインポート（@/〜）に必須

2. **設定ファイルの段階的検証**

   - Vite, TypeScript, ESLint等の設定ファイルは変更後に即テスト実行
   - 小さな変更を積み重ねる方が効率的で問題発見も容易

3. **TODOリストによる進捗管理**
   - 大きなタスクを小さなステップに分解して管理
   - 完了したタスクをマークすることでモチベーション維持と進捗可視化

### 具体的なナレッジ（ツールの使い方やハマりやすいポイント）

1. **shadcn/uiの導入手順**

   - npx shadcn@latest initではなく、古いshadcn-uiコマンドは非推奨
   - コンポーネントは個別にnpx shadcn@latest add [コンポーネント名]でインストール
   - React 19との互換性のために--forceオプションが必要な場合あり

2. **import alias設定のポイント**

   - tsconfig.jsonだけでなくvite.config.tsにも同じパス設定が必要
   - `@/*`→`./src/*`の設定は両方のファイルで一致させる

3. **Playwrightテストの注意点**
   - サンプルテスト(example.spec.ts)は外部サイトにアクセスするため削除または修正が必要
   - 開発サーバー起動中にテスト実行する場合は別ターミナルが必要
   - 一部ブラウザ依存ライブラリがなくても基本テストは実行可能

## Step 2: 基本レイアウト構築（2025-04-30）

### うまくいった手法（手順）

1. **4分割レイアウトの段階的実装**
   - 最初にシンプルなTailwindフレックスレイアウトで基本構造を作成
   - 次にshadcn/uiコンポーネントを順次統合（Sheet, Select, Separator等）
   - 最後にレスポンシブ対応とiPad横向き最適化を追加

2. **UIコンポーネントの効果的な組み合わせ**
   - シートコンポーネントをサイドメニューに活用し、モバイル表示時の切り替えを実現
   - セレクトコンポーネントでレベル選択UIをシンプルに実装
   - lucide-reactのアイコンでUIの視認性向上

3. **Playwrightテストの段階的構築**
   - 最初は基本的なUI要素の存在確認テストから開始
   - 次に動的な要素（ドロップダウン等）の機能テストを追加
   - 最終的に全ブラウザ互換性を確保するためのセレクタ最適化

### 汎用的なナレッジ（タスク進め方や問題解決手法など）

1. **UIテストのロバスト性確保手法**
   - 複数のセレクタを用意し、最初に見つかったものを使用する戦略
   - テキスト内容と要素の役割（role）の両方を確認
   - 複数のブラウザエンジンで検証して互換性を確保

2. **DOM構造変化の検証アプローチ**
   - 動的UIの変化は要素数の増減で確実に検出
   - data-state属性などのDOM属性変化も重要な検証ポイント
   - 画面サイズ変更時のレイアウト変化も適切にテスト

3. **デバッグ出力を活用したテスト改善**
   - コンソールログでDOMの構造や属性を詳細に出力
   - 将来の拡張に備えてDOM階層とデータ属性を文書化
   - スクリーンショットを取得して状態を視覚的に記録

### 具体的なナレッジ（ツールの使い方やハマりやすいポイント）

1. **shadcn/ui (Radix UI) コンポーネントのテスト**
   - Radix UIはポータル（data-radix-popper-content-wrapper）を使用するため通常のDOM階層では捕捉できない
   - ドロップダウンなどは `role="listbox"`, `role="option"` 属性で確実に特定可能
   - `data-state="open"` 属性は要素の状態変化を検知するのに最適

2. **Playwrightでのブラウザ互換性対応**
   - WebKit (Safari) テストは追加のシステムライブラリが必要（libgstcodecparsers等）
   - クリック後のstate変化を待つには `page.waitForTimeout(500)` が効果的
   - テスト分割（Chromium+Firefox用と全ブラウザ用）でCI/CD効率化

3. **レスポンシブUIのテスト技法**
   - 複数のビューポートサイズ（375, 768, 1024）でのテストが必須
   - 共通の視覚要素と位置だけでなく、表示/非表示の切り替わりもテスト
   - iPad横向き（1024x768）は特に重要なターゲットサイズ
